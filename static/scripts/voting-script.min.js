// (c) 2020 Simon Ludwig
function $(e){return document.getElementById(e)}var btn=$("submit-vote"),returntxt=$("returntxt"),fname_input=$("fname"),lname_input=$("lname"),date_radios=document.getElementsByName("vote-deposit"),datepicker_wrap=$("datepicker-wrap"),donate_custom_box=$("custom-donate-wrap"),donate_radios=document.getElementsByName("vote-donate"),celebration_radios=document.getElementsByName("vote-celebration");$("specify-date-wrap").addEventListener("click",function(){datepicker_wrap.style.height="85px"}),$("asap-wrap").addEventListener("click",function(){datepicker_wrap.style.height="0px"}),$("01122020-wrap").addEventListener("click",function(){datepicker_wrap.style.height="0px"}),$("donate-custom-radio-wrap").addEventListener("click",function(){donate_custom_box.style.height="85px"}),$("donate-donate-wrap").addEventListener("click",function(){donate_custom_box.style.height="0px"}),$("donate-split-wrap").addEventListener("click",function(){donate_custom_box.style.height="0px"}),btn.addEventListener("click",function(){if(1==btn.disabled)return!1;btn.disabled=!0,window.scrollTo(0,document.body.scrollHeight),returntxt.innerHTML="L&auml;dt...";var e=fname_input.value,t=lname_input.value,n="",a="",r="";if(""==e||e.length<3)return returntxt.innerHTML="Bitte gib deinen Vornamen ein!",btn.disabled=!1,!1;if(""==t||t.length<3)return returntxt.innerHTML="Bitte gib deinen Nachnamen ein!",btn.disabled=!1,!1;for(var i=0,d=date_radios.length;i<d;i++)if(date_radios[i].checked){a=date_radios[i].value;break}for(i=0,d=donate_radios.length;i<d;i++)if(donate_radios[i].checked){n=donate_radios[i].value;break}for(i=0,d=celebration_radios.length;i<d;i++)if(celebration_radios[i].checked){r=celebration_radios[i].value;break}if("custom"==a&&10!=(a=$("custom-date").value.replace("/[^0-9-./]/","")).length)return returntxt.innerHTML="Bitte &uuml;berpr&uuml;fe deine Eingabe!",btn.disabled=!1,!1;if("donate-custom"==n&&(n=$("custom-donate").value.replace(/['"Â´`><]+/g,"")),""==a||""==n||""==r)return returntxt.innerHTML="Bitte &uuml;berpr&uuml;fe deine Eingabe!",btn.disabled=!1,!1;var o=new FormData;o.append("fname",e),o.append("lname",t),o.append("payment_term",a),o.append("donate",n),o.append("celebrate",r),o.append("party_idea",$("party-idea").value),o.append("token",$("token").value);var s=new XMLHttpRequest;s.open("POST","https://ifdd.me/ajax-handler"),s.onreadystatechange=function(){if(4==s.readyState&&200==s.status){var e=s.responseText;returntxt.innerHTML="error_name_not_found"==e?"Dein Name konnte leider nicht gefunden werden! Hast du ihn richtig eingegeben?":"error_already_voted"==e?"Du hast offenbar schon abgestimmt!":"error_expired"==e?"Die Abstimmung ist leider schon geschlossen :(":"error_internal"==e||""==e?"Oh fuck, es ist offenbar ein interner Fehler aufgetreten! Das sollte eigentlich nicht passieren :(":"error_token"==e?"Deine Sitzung ist abgelaufen, bitte lade die Seite neu. Evtl. musst du auch Cookies aktivieren.":"Danke dir, "+e+"! Du hast erfolgreich abgestimmt :)",btn.disabled=!1}},s.send(o)},!1);
